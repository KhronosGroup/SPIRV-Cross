#include <metal_stdlib>
#include <simd/simd.h>

using namespace metal;

struct SSBO
{
    float3x4 A;
    float3x4 B;
    float3x4 C;
    float4 D;
    float w0;
    float w1;
};

constant uint3 gl_WorkGroupSize [[maybe_unused]] = uint3(64u, 1u, 1u);

kernel void main0(device SSBO& _12 [[buffer(0)]])
{
    float3x4 _23 = _12.A * _12.w0;
    float3x4 _30 = _12.B * _12.w1;
    _12.D = float4(float4x3(float3(_23[0][0], _23[1][0], _23[2][0]) + float3(_30[0][0], _30[1][0], _30[2][0]), float3(_23[0][1], _23[1][1], _23[2][1]) + float3(_30[0][1], _30[1][1], _30[2][1]), float3(_23[0][2], _23[1][2], _23[2][2]) + float3(_30[0][2], _30[1][2], _30[2][2]), float3(_23[0][3], _23[1][3], _23[2][3]) + float3(_30[0][3], _30[1][3], _30[2][3])) * _12.D, 1.0);
}

